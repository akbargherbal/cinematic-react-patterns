{
  "moduleId": "usecallback-westworld-loops",
  "fiction": {
    "title": "Westworld",
    "author": "Jonathan Nolan, Lisa Joy",
    "year": 2016,
    "type": "tv-series",
    "genre": ["science fiction", "western", "drama"],
    "keyElements": [
      "Dolores Abernathy",
      "Teddy Flood",
      "Sweetwater",
      "Perfect Loop",
      "Can of milk",
      "onSeeDolores.js",
      "Reverie",
      "Bernard Lowe",
      "Dr. Ford",
      "Mesa Hub",
      "PROP_CALLBACK_IDENTITY_CHANGED"
    ]
  },
  "metaphor": {
    "core": "The repetitive 'loops' of hosts like Dolores and Teddy in 'Westworld', and the underlying programming that dictates their interactions, serve as a metaphor for the React `useCallback` hook. The module illustrates how passing a newly created function as a prop on every parent re-render (Dolores's loop) can cause unnecessary re-renders in optimized child components (Teddy), leading to performance issues. `useCallback` is presented as a 'memorize directive' that stabilizes the function's identity across renders, preventing wasteful recalculations by child components and ensuring that functions are only recreated when their dependencies (like a 'reverie') truly change.",
    "mapping": [
      {
        "fictionElement": "Dolores Abernathy (parent host)",
        "reactConcept": "A parent React component that defines and passes a callback function as a prop to a child."
      },
      {
        "fictionElement": "Teddy Flood (child host)",
        "reactConcept": "A child React component, often memoized (`React.memo`), that receives a callback function as a prop and re-renders if the callback's identity changes."
      },
      {
        "fictionElement": "The Perfect Loop (Dolores's daily routine)",
        "reactConcept": "The parent component (Dolores) re-rendering, causing its child components (Teddy) to re-render as well."
      },
      {
        "fictionElement": "Can of milk dropping (event trigger)",
        "reactConcept": "An event that triggers a callback function passed from parent to child."
      },
      {
        "fictionElement": "Re-compiling `handleDropCan` / new memory address",
        "reactConcept": "JavaScript's behavior of creating a new function reference on every render when a function is defined inline in a component."
      },
      {
        "fictionElement": "PROP_CALLBACK_IDENTITY_CHANGED (Teddy's diagnostic flash)",
        "reactConcept": "The performance overhead of a memoized child component receiving a new function reference (even if functionally identical) on every render, causing it to unnecessarily re-render."
      },
      {
        "fictionElement": "The Memorize Directive (Dr. Ford's intervention)",
        "reactConcept": "The `useCallback` hook, which memoizes a function, returning the same function instance across renders unless one of its dependencies changes."
      },
      {
        "fictionElement": "Reverie (dependency)",
        "reactConcept": "A dependency in the `useCallback` dependency array; if this value changes, `useCallback` will return a new function instance."
      },
      {
        "fictionElement": "Stable foundation / optimized system",
        "reactConcept": "The performance benefits and stability achieved by `useCallback` preventing unnecessary re-renders in child components."
      }
    ],
    "narrativeArc": "The module starts with 'The Perfect Loop' of Dolores and Teddy, demonstrating the baseline of interaction. 'The Novelty of the Script' reveals the performance cost of new function identities on every render (without `useCallback`). Dr. Ford introduces 'The Memorize Directive' (`useCallback`) to stabilize function identities. 'The Reverie and the Reason' illustrates how dependencies control when a memoized function should be recreated. The module concludes with 'The Architect's Principle', summarizing how `useCallback` creates stable foundations for efficient React applications."
  },
  "concepts": {
    "primary": "useCallback Hook",
    "secondary": [
      "Memoization",
      "Function Identity",
      "Performance Optimization",
      "Child Component Re-renders",
      "React.memo",
      "Dependency Array",
      "Referential Equality",
      "Functional Components"
    ],
    "problems": [
      "Unnecessary re-renders in memoized child components caused by new function instances passed as props on every parent re-render",
      "Performance overhead in applications with many callback props and frequently updated parent components."
    ],
    "reactAPIs": ["useCallback", "useState", "useEffect", "memo (React.memo)"]
  },
  "structure": {
    "format": "chapter-based",
    "chapters": [
      {
        "title": "The Perfect Loop",
        "focus": "Introduces the concept of parent-child component interaction through callback functions passed as props."
      },
      {
        "title": "The Novelty of the Script",
        "focus": "Demonstrates the anti-pattern: how new function instances created on every render cause unnecessary re-renders in optimized child components, leading to performance costs."
      },
      {
        "title": "The Memorize Directive",
        "focus": "Explains and demonstrates `useCallback` as a solution to memoize callback functions, stabilizing their identity across renders."
      },
      {
        "title": "The Reverie and the Reason",
        "focus": "Illustrates the importance of the dependency array in `useCallback` to control when the memoized function should be recreated, allowing for intentional updates."
      },
      {
        "title": "The Architect's Principle",
        "focus": "Summarizes the role of `useCallback` in building stable, performant React applications by preventing unnecessary child component re-renders and maintaining component purity."
      }
    ],
    "pedagogicalApproach": "narrative|problem-solution|contrast-driven|progressive",
    "interactiveElements": [
      "Simulating parent component re-renders and observing child component re-render counts (with and without `useCallback`)",
      "Visualizing performance spikes caused by unmemoized callbacks",
      "Interactive controls to demonstrate how changing a dependency in `useCallback` triggers a new function instance and child re-render",
      "Side-by-side comparison mode showing performance metrics for broken vs. fixed implementations.",
      "Tracking Dolores's and Teddy's render counts and overall can count."
    ]
  },
  "search": {
    "keywords": [
      "React useCallback",
      "Memoization Hooks React",
      "Function Identity React",
      "Prevent Re-renders React",
      "React Performance Optimization",
      "React.memo useCallback",
      "Dependency Array Hook",
      "Westworld React",
      "Dolores Teddy useCallback",
      "Jonathan Nolan",
      "Lisa Joy"
    ],
    "themes": ["performance", "optimization", "hooks", "memoization", "component communication"],
    "difficulty": "intermediate",
    "prerequisites": [],
    "relatedModules": []
  }
}